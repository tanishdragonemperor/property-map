<!DOCTYPE html>
<html>
<head>
  <title>Nearby Properties</title>
  <style>
    #map { height: 100vh; width: 100%; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    const query = new URLSearchParams(window.location.search);
    const lat = parseFloat(query.get("lat"));
    const lng = parseFloat(query.get("lng"));
    const markers = JSON.parse(decodeURIComponent(query.get("markers")));

    function initMap() {
      const center = { lat: lat, lng: lng };
      const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 12,
        center: center,
      });

      // Center marker
      new google.maps.Marker({
        position: center,
        map: map,
        title: "You",
        icon: {
          path: google.maps.SymbolPath.CIRCLE,
          scale: 10,
          fillColor: "black",
          fillOpacity: 1,
          strokeColor: "white",
          strokeWeight: 2
        }
      });

      // Property markers
      markers.forEach(m => {
        new google.maps.Marker({
          position: { lat: m.lat, lng: m.lng },
          map: map,
          title: m.name,
          icon: {
            path: google.maps.SymbolPath.CIRCLE,
            scale: 8,
            fillColor: m.color,
            fillOpacity: 0.9,
            strokeColor: "white",
            strokeWeight: 1
          }
        });
      });
    }
  </script>
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap">
  </script>
</body>
</html>
